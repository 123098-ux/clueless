<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Online Clapper</title>
  <style>
    body {
      text-align: center;
      font-family: sans-serif;
      background: #f5f5f5;
      margin-top: 50px;
    }
    #clap {
      font-size: 100px;
      transition: transform 0.1s ease;
    }
    .clap-animate {
      transform: scale(1.3) rotate(10deg);
    }
    #status {
      margin-top: 20px;
      font-size: 18px;
      color: gray;
    }
  </style>
</head>
<body>

  <h1>👏 Online Clapper 👏</h1>
  <div id="clap">👐</div>
  <div id="status">Listening for claps...</div>

  <script>
    const clapEl = document.getElementById("clap");
    const statusEl = document.getElementById("status");

    // Get microphone input
    navigator.mediaDevices.getUserMedia({ audio: true })
      .then(stream => {
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const source = audioCtx.createMediaStreamSource(stream);
        const analyser = audioCtx.createAnalyser();
        const dataArray = new Uint8Array(analyser.fftSize);

        source.connect(analyser);

        function detectClap() {
          analyser.getByteTimeDomainData(dataArray);
          let max = Math.max(...dataArray);

          // Threshold (basic — you can improve this)
          if (max > 200) {
            statusEl.textContent = "Clap detected!";
            triggerClapAnimation();
          } else {
            statusEl.textContent = "Listening for claps...";
          }

          requestAnimationFrame(detectClap);
        }

        function triggerClapAnimation() {
          // Delay for awkwardness 😅
          setTimeout(() => {
            clapEl.classList.add("clap-animate");
            setTimeout(() => clapEl.classList.remove("clap-animate"), 300);
          }, 600); // 600ms delay = awkward
        }

        detectClap();
      })
      .catch(err => {
        statusEl.textContent = "Microphone access denied 😢";
        console.error(err);
      });
  </script>

</body>
</html>
